{"ast":null,"code":"// jwt code from https://git.generalassemb.ly/dc-wdi-react-redux/react-jwt-authentication\nconst express = require(\"express\");\n\nconst router = express.Router();\n\nconst jwt = require(\"jwt-simple\");\n\nconst passport = require(\"../config/passport\");\n\nconst config = require(\"../config/config\");\n\nconst mongoose = require(\"../models/User\");\n\nconst User = mongoose.model(\"User\");\nmodule.exports = router;\nrouter.post(\"/signup\", (req, res) => {\n  if (req.body.email && req.body.password) {\n    let newUser = {\n      email: req.body.email,\n      password: req.body.password\n    };\n    User.findOne({\n      email: req.body.email\n    }).then(user => {\n      if (!user) {\n        User.create(newUser).then(user => {\n          if (user) {\n            var payload = {\n              id: newUser.id\n            };\n            var token = jwt.encode(payload, config.jwtSecret);\n            res.json({\n              token: token\n            });\n          } else {\n            res.sendStatus(401);\n          }\n        });\n      } else {\n        res.sendStatus(401);\n      }\n    });\n  } else {\n    res.sendStatus(401);\n  }\n});\nmodule.exports = router;","map":{"version":3,"sources":["/Users/Tenley/SEI/Projects/beatles-mern-project/beatles-mern/src/controllers/users.js"],"names":["express","require","router","Router","jwt","passport","config","mongoose","User","model","module","exports","post","req","res","body","email","password","newUser","findOne","then","user","create","payload","id","token","encode","jwtSecret","json","sendStatus"],"mappings":"AAAA;AAEA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AACA,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAR,EAAf;;AACA,MAAMC,GAAG,GAAGH,OAAO,CAAC,YAAD,CAAnB;;AACA,MAAMI,QAAQ,GAAGJ,OAAO,CAAC,oBAAD,CAAxB;;AACA,MAAMK,MAAM,GAAGL,OAAO,CAAC,kBAAD,CAAtB;;AACA,MAAMM,QAAQ,GAAGN,OAAO,CAAC,gBAAD,CAAxB;;AACA,MAAMO,IAAI,GAAGD,QAAQ,CAACE,KAAT,CAAe,MAAf,CAAb;AACAC,MAAM,CAACC,OAAP,GAAiBT,MAAjB;AAEAA,MAAM,CAACU,IAAP,CAAY,SAAZ,EAAuB,CAACC,GAAD,EAAMC,GAAN,KAAc;AACnC,MAAID,GAAG,CAACE,IAAJ,CAASC,KAAT,IAAkBH,GAAG,CAACE,IAAJ,CAASE,QAA/B,EAAyC;AACvC,QAAIC,OAAO,GAAG;AACZF,MAAAA,KAAK,EAAEH,GAAG,CAACE,IAAJ,CAASC,KADJ;AAEZC,MAAAA,QAAQ,EAAEJ,GAAG,CAACE,IAAJ,CAASE;AAFP,KAAd;AAIAT,IAAAA,IAAI,CAACW,OAAL,CAAa;AAAEH,MAAAA,KAAK,EAAEH,GAAG,CAACE,IAAJ,CAASC;AAAlB,KAAb,EAAwCI,IAAxC,CAA8CC,IAAD,IAAU;AACrD,UAAI,CAACA,IAAL,EAAW;AACTb,QAAAA,IAAI,CAACc,MAAL,CAAYJ,OAAZ,EAAqBE,IAArB,CAA2BC,IAAD,IAAU;AAClC,cAAIA,IAAJ,EAAU;AACR,gBAAIE,OAAO,GAAG;AACZC,cAAAA,EAAE,EAAEN,OAAO,CAACM;AADA,aAAd;AAGA,gBAAIC,KAAK,GAAGrB,GAAG,CAACsB,MAAJ,CAAWH,OAAX,EAAoBjB,MAAM,CAACqB,SAA3B,CAAZ;AACAb,YAAAA,GAAG,CAACc,IAAJ,CAAS;AACPH,cAAAA,KAAK,EAAEA;AADA,aAAT;AAGD,WARD,MAQO;AACLX,YAAAA,GAAG,CAACe,UAAJ,CAAe,GAAf;AACD;AACF,SAZD;AAaD,OAdD,MAcO;AACLf,QAAAA,GAAG,CAACe,UAAJ,CAAe,GAAf;AACD;AACF,KAlBD;AAmBD,GAxBD,MAwBO;AACLf,IAAAA,GAAG,CAACe,UAAJ,CAAe,GAAf;AACD;AACF,CA5BD;AA8BAnB,MAAM,CAACC,OAAP,GAAiBT,MAAjB","sourcesContent":["// jwt code from https://git.generalassemb.ly/dc-wdi-react-redux/react-jwt-authentication\n\nconst express = require(\"express\");\nconst router = express.Router();\nconst jwt = require(\"jwt-simple\");\nconst passport = require(\"../config/passport\");\nconst config = require(\"../config/config\");\nconst mongoose = require(\"../models/User\");\nconst User = mongoose.model(\"User\");\nmodule.exports = router;\n\nrouter.post(\"/signup\", (req, res) => {\n  if (req.body.email && req.body.password) {\n    let newUser = {\n      email: req.body.email,\n      password: req.body.password,\n    };\n    User.findOne({ email: req.body.email }).then((user) => {\n      if (!user) {\n        User.create(newUser).then((user) => {\n          if (user) {\n            var payload = {\n              id: newUser.id,\n            };\n            var token = jwt.encode(payload, config.jwtSecret);\n            res.json({\n              token: token,\n            });\n          } else {\n            res.sendStatus(401);\n          }\n        });\n      } else {\n        res.sendStatus(401);\n      }\n    });\n  } else {\n    res.sendStatus(401);\n  }\n});\n\nmodule.exports = router;\n"]},"metadata":{},"sourceType":"module"}